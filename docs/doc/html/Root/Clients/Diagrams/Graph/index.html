<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<HTML>
<HEAD>
<TITLE>
Graph
</TITLE>
</HEAD>
<FONT SIZE="+2"><B>Graph</B></FONT><BR><BR><HR>
<FONT SIZE="+1"><B>Overview</B></FONT><BR>
<P>
No Documentation Specified
<BR><HR><BR>
<B>Parents</B>
<A HREF="../../../../Root/XCore/Object/index.html">Object</A>
,<A HREF="../../../../Root/XCore/Element/index.html">Element</A>
<BR><HR><BR>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TD COLSPAN=2><FONT SIZE="+2">
<B>Constructors</B></FONT></TD>
</TR>
<TR><TD>Graph()</TD><TD> No Documentation </TD></TR>
<TR><TD>Graph(nodes,edges)</TD><TD> No Documentation </TD></TR>
</TABLE>
<BR><HR><BR>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TD COLSPAN=3><FONT SIZE="+2">
<B>Attributes</B></FONT></TD>
</TR>
<TR><TD><B>edges</B></TD><TD><A HREF="../../../../Root/Clients/Diagrams/DiagramLayout/Edge/index.html">Seq(Edge)<A></TD><TD>No Documentation Specified</TD></TR>
<TR><TD><B>nodes</B></TD><TD><A HREF="../../../../Root/Clients/Diagrams/DiagramLayout/Node/index.html">Seq(Node)<A></TD><TD>No Documentation Specified</TD></TR>
<TR>
<TD COLSPAN=3>
<FONT SIZE="-1">
<B>From</B> <A HREF="../../../../Root/XCore/Element/index.html">Element</A>: roleFiller. <BR></FONT>
</TD>
</TR>
</TABLE>
<BR><HR><BR>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="2" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TD COLSPAN=2><FONT SIZE="+2">
<B>Operations</B></FONT></TD>
</TR>
<TR><TD><B><a href="#addEdge">addEdge</a>(edge:<A HREF="../../../../Root/Clients/Diagrams/DiagramLayout/Edge/index.html">Edge<A>):<A HREF="../../../../Root/XCore/Element/index.html">Element<A></B></TD><TD>No Documentation Specified</TD></TR>
<TR><TD><B><a href="#addNode">addNode</a>(node:<A HREF="../../../../Root/Clients/Diagrams/DiagramLayout/Node/index.html">Node<A>):<A HREF="../../../../Root/XCore/Element/index.html">Element<A></B></TD><TD>No Documentation Specified</TD></TR>
<TR><TD><B><a href="#applyLayout">applyLayout</a>(layout:<A HREF="../../../../Root/XML/Element/index.html">Element<A>):<A HREF="../../../../Root/XCore/Element/index.html">Element<A></B></TD><TD>No Documentation Specified</TD></TR>
<TR><TD><B><a href="#circulate">circulate</a>(width:<A HREF="../../../../Root/XCore/Element/index.html">Element<A>,height:<A HREF="../../../../Root/XCore/Element/index.html">Element<A>,dx:<A HREF="../../../../Root/XCore/Element/index.html">Element<A>,dy:<A HREF="../../../../Root/XCore/Element/index.html">Element<A>):<A HREF="../../../../Root/XCore/Element/index.html">Element<A></B></TD><TD>No Documentation Specified</TD></TR>
<TR><TD><B><a href="#containsEdge">containsEdge</a>(edge:<A HREF="../../../../Root/XCore/Element/index.html">Element<A>):<A HREF="../../../../Root/XCore/Element/index.html">Element<A></B></TD><TD>No Documentation Specified</TD></TR>
<TR><TD><B><a href="#containsNode">containsNode</a>(node:<A HREF="../../../../Root/XCore/Element/index.html">Element<A>):<A HREF="../../../../Root/XCore/Element/index.html">Element<A></B></TD><TD>No Documentation Specified</TD></TR>
<TR><TD><B><a href="#deepContains">deepContains</a>(n:<A HREF="../../../../Root/Clients/Diagrams/DiagramLayout/Node/index.html">Node<A>):<A HREF="../../../../Root/XCore/Element/index.html">Element<A></B></TD><TD>No Documentation Specified</TD></TR>
<TR><TD><B><a href="#delete">delete</a>():<A HREF="../../../../Root/XCore/Element/index.html">Element<A></B></TD><TD>No Documentation Specified</TD></TR>
<TR><TD><B><a href="#deselectAll">deselectAll</a>():<A HREF="../../../../Root/XCore/Element/index.html">Element<A></B></TD><TD>No Documentation Specified</TD></TR>
<TR><TD><B><a href="#dispose">dispose</a>():<A HREF="../../../../Root/XCore/Element/index.html">Element<A></B></TD><TD>No Documentation Specified</TD></TR>
<TR><TD><B><a href="#disposeId">disposeId</a>(disposeChildren:<A HREF="../../../../Root/XCore/Element/index.html">Element<A>):<A HREF="../../../../Root/XCore/Element/index.html">Element<A></B></TD><TD>No Documentation Specified</TD></TR>
<TR><TD><B><a href="#edges">edges</a>():<A HREF="../../../../Root/XCore/Element/index.html">Element<A></B></TD><TD>No Documentation Specified</TD></TR>
<TR><TD><B><a href="#edgesConnectedTo">edgesConnectedTo</a>(node:<A HREF="../../../../Root/XCore/Element/index.html">Element<A>):<A HREF="../../../../Root/XCore/Element/index.html">Element<A></B></TD><TD>No Documentation Specified</TD></TR>
<TR><TD><B><a href="#findEdgeElement">findEdgeElement</a>(id:<A HREF="../../../../Root/XCore/Element/index.html">Element<A>):<A HREF="../../../../Root/XCore/Element/index.html">Element<A></B></TD><TD>No Documentation Specified</TD></TR>
<TR><TD><B><a href="#findElement">findElement</a>(id:<A HREF="../../../../Root/XCore/Element/index.html">Element<A>):<A HREF="../../../../Root/XCore/Element/index.html">Element<A></B></TD><TD>No Documentation Specified</TD></TR>
<TR><TD><B><a href="#findNodeElement">findNodeElement</a>(id:<A HREF="../../../../Root/XCore/Element/index.html">Element<A>):<A HREF="../../../../Root/XCore/Element/index.html">Element<A></B></TD><TD>No Documentation Specified</TD></TR>
<TR><TD><B><a href="#layout">layout</a>():<A HREF="../../../../Root/XCore/Element/index.html">Element<A></B></TD><TD>No Documentation Specified</TD></TR>
<TR><TD><B><a href="#layoutData">layoutData</a>():<A HREF="../../../../Root/Clients/Diagrams/DiagramLayout/Layout/index.html">Layout<A></B></TD><TD>No Documentation Specified</TD></TR>
<TR><TD><B><a href="#layoutEdge">layoutEdge</a>(layout:<A HREF="../../../../Root/XML/Element/index.html">Element<A>):<A HREF="../../../../Root/XCore/Element/index.html">Element<A></B></TD><TD>No Documentation Specified</TD></TR>
<TR><TD><B><a href="#layoutEdgeData">layoutEdgeData</a>():<A HREF="../../../../Root/XML/Element/index.html">Seq(Element)<A></B></TD><TD>No Documentation Specified</TD></TR>
<TR><TD><B><a href="#layoutMove">layoutMove</a>(n1:<A HREF="../../../../Root/XCore/Element/index.html">Element<A>,n2:<A HREF="../../../../Root/XCore/Element/index.html">Element<A>,G:<A HREF="../../../../Root/XCore/Element/index.html">Element<A>,checkDist:<A HREF="../../../../Root/XCore/Element/index.html">Element<A>,nodeModifier:<A HREF="../../../../Root/XCore/Element/index.html">Element<A>):<A HREF="../../../../Root/XCore/Element/index.html">Element<A></B></TD><TD>No Documentation Specified</TD></TR>
<TR><TD><B><a href="#layoutNode">layoutNode</a>(layout:<A HREF="../../../../Root/XML/Element/index.html">Element<A>):<A HREF="../../../../Root/XCore/Element/index.html">Element<A></B></TD><TD>No Documentation Specified</TD></TR>
<TR><TD><B><a href="#layoutNodeData">layoutNodeData</a>():<A HREF="../../../../Root/XML/Element/index.html">Seq(Element)<A></B></TD><TD>No Documentation Specified</TD></TR>
<TR><TD><B><a href="#new">new</a>(diagram:<A HREF="../../../../Root/XCore/Element/index.html">Element<A>,setMenu:<A HREF="../../../../Root/XCore/Element/index.html">Element<A>):<A HREF="../../../../Root/XCore/Element/index.html">Element<A></B></TD><TD>No Documentation Specified</TD></TR>
<TR><TD><B><a href="#new">new</a>(parent:<A HREF="../../../../Root/XCore/Element/index.html">Element<A>):<A HREF="../../../../Root/XCore/Element/index.html">Element<A></B></TD><TD>No Documentation Specified</TD></TR>
<TR><TD><B><a href="#nodes">nodes</a>():<A HREF="../../../../Root/XCore/Element/index.html">Element<A></B></TD><TD>No Documentation Specified</TD></TR>
<TR><TD><B><a href="#preferenceChange">preferenceChange</a>():<A HREF="../../../../Root/XCore/Element/index.html">Element<A></B></TD><TD>No Documentation Specified</TD></TR>
<TR><TD><B><a href="#removeEdge">removeEdge</a>(edge:<A HREF="../../../../Root/XCore/Element/index.html">Element<A>):<A HREF="../../../../Root/XCore/Element/index.html">Element<A></B></TD><TD>No Documentation Specified</TD></TR>
<TR><TD><B><a href="#removeNode">removeNode</a>(node:<A HREF="../../../../Root/XCore/Element/index.html">Element<A>):<A HREF="../../../../Root/XCore/Element/index.html">Element<A></B></TD><TD>No Documentation Specified</TD></TR>
<TR><TD><B><a href="#renew">renew</a>(diagram:<A HREF="../../../../Root/XCore/Element/index.html">Element<A>):<A HREF="../../../../Root/XCore/Element/index.html">Element<A></B></TD><TD>No Documentation Specified</TD></TR>
<TR><TD><B><a href="#selected">selected</a>():<A HREF="../../../../Root/XCore/Element/index.html">Element<A></B></TD><TD>No Documentation Specified</TD></TR>
<TR><TD><B><a href="#sourceNode">sourceNode</a>(edge:<A HREF="../../../../Root/XCore/Element/index.html">Element<A>):<A HREF="../../../../Root/XCore/Element/index.html">Element<A></B></TD><TD>No Documentation Specified</TD></TR>
<TR><TD><B><a href="#svgEdgeDecorators">svgEdgeDecorators</a>(out:<A HREF="../../../../Root/XCore/Element/index.html">Element<A>):<A HREF="../../../../Root/XCore/Element/index.html">Element<A></B></TD><TD>No Documentation Specified</TD></TR>
<TR><TD><B><a href="#svgFooter">svgFooter</a>(out:<A HREF="../../../../Root/XCore/Element/index.html">Element<A>):<A HREF="../../../../Root/XCore/Element/index.html">Element<A></B></TD><TD>No Documentation Specified</TD></TR>
<TR><TD><B><a href="#svgHeader">svgHeader</a>(out:<A HREF="../../../../Root/XCore/Element/index.html">Element<A>):<A HREF="../../../../Root/XCore/Element/index.html">Element<A></B></TD><TD>No Documentation Specified</TD></TR>
<TR><TD><B><a href="#synchronise">synchronise</a>():<A HREF="../../../../Root/XCore/Element/index.html">Element<A></B></TD><TD>No Documentation Specified</TD></TR>
<TR><TD><B><a href="#targetNode">targetNode</a>(edge:<A HREF="../../../../Root/XCore/Element/index.html">Element<A>):<A HREF="../../../../Root/XCore/Element/index.html">Element<A></B></TD><TD>No Documentation Specified</TD></TR>
<TR><TD><B><a href="#toSVG">toSVG</a>(out:<A HREF="../../../../Root/XCore/Element/index.html">Element<A>):<A HREF="../../../../Root/XCore/Element/index.html">Element<A></B></TD><TD>No Documentation Specified</TD></TR>
<TR>
<TD COLSPAN=2>
<FONT SIZE="-1">
<B>From</B> <A HREF="../../../../Root/XCore/Object/index.html">Object</A>: addDaemon, addDiagramListener, addMissingSlot, addMultiDaemon, addPersistentDaemon, addStructuralFeature, allCompositeValues, allCompositeValuesAndSelf, allDaemonsWithId, allDaemonsWithTarget, applyMapping_client, calcChildrenSlots, changedOnDiagram, compositeValues, daemonNamed, daemonWithId, daemonWithIdAndTarget, daemons, daemonsActive, destroyDaemon, edit, fire, get, getAvailableMappings, getChildren, getChildrenSlots, getChildrenToolTips, getDiagramListenerNamed, getDiagramListeners, getProperties, getProperty, getStructuralFeatureNames, hasDaemonNamed, hasDaemonWithId, hasDaemonWithIdAndTarget, hasDaemonWithTarget, hasProperty, hasSlot, hasStructuralFeature, hotLoad, hotLoaded, ignoreBy, ignoreByAll, init, initSlots, machineInit, nodeEvent, observeBy, observeBy, observedBy, observedBy, oldEdit, orderSequence, orderSequence, propertyTarget, removeDaemon, removeDaemonNamed, removeDaemonsWithId, removeDaemonsWithTarget, removeDiagramListener, removeDiagramListeners, removeStructuralFeature, renameSlot, saveXTO, saveXTOFile, set, setDaemons, setDaemonsActive, setHotLoad, setProperty, showAndLayoutDiagram, showDiagram, slotDenied, slotMissing, slotMissing, slots, synchronise. <BR><B>From</B> <A HREF="../../../../Root/XCore/Element/index.html">Element</A>: addTo, allHTMLEntries, allHTMLPackages, assignToGlobal, assignToGlobal, browse, browse_redirect, checkConstraints, copy, copyToClipboard, copyToClipboard_transaction, createDiagram, createDiagramType, createDiagramType, createDiagramType, createTool, cutToClipboard, cutToClipboard_transaction, deleteRecursive, deployXML, die, doc, doubleClick, edit, edit_redirect, equals, error, evaluateExpression, ferror, getChildren, getChildrenToolTips, getDefaultClipboardSource, getDefaultClipboardTarget, graphVizNode, hashCode, init, init, invokeOp, isDeleteProtected, isKindOf, isProtected, isReallyKindOf, isTypeOf, isViewProtected, isWithinNameSpace, labelString, legalNameChangeCheck, legalSlotChangeCheck, legalSlotChangeCheck, lift, nameString, noOperationFound, oclIsKindOf, oclIsTypeOf, of, oldShowDiagram, pasteFromClipboard, populateGraphViz, pprint, pprint, pprint, pprintln, print, println, removeDaemon, removeDaemon, save, save2, selectDiagram, selectModelBrowserNode, send, setDelegation, setOf, setRoleFillerDialog, showAndLayoutDiagram, showDiagram, showModelBrowserNode, slotAffectsLabel, systemId, toHTML, toSVG, toSnapshot, toSnapshot, toString, toType, writeHTML, writeHTML, writeHTMLAllEntries, writeHTMLAllPackages, writeHTMLIndex, writeHTMLOverview, writeXML, writeXMLFile, yield. <BR><TR><TD COLSPAN=2><a name="addEdge"/><FONT FACE="Courier" SIZE="1">@Operation&#160;addEdge(edge&#160;:&#160;Edge):XCore::Element<br>&#160;&#160;self.edges&#160;:=&#160;edges-&gt;prepend(edge)<br>end</FONT>
</TD></TR>
<TR><TD COLSPAN=2><a name="addNode"/><FONT FACE="Courier" SIZE="1">@Operation&#160;addNode(node&#160;:&#160;Node):XCore::Element<br>&#160;&#160;self.nodes&#160;:=&#160;nodes-&gt;prepend(node)<br>end</FONT>
</TD></TR>
<TR><TD COLSPAN=2><a name="applyLayout"/><FONT FACE="Courier" SIZE="1">@Operation&#160;applyLayout(layout&#160;:&#160;XML::Element):XCore::Element<br>&#160;&#160;@For&#160;data&#160;in&#160;layout.children&#160;do<br>&#160;&#160;&#160;&#160;if&#160;data.tag&#160;=&#160;"Node"<br>&#160;&#160;&#160;&#160;then&#160;self.layoutNode(data)<br>&#160;&#160;&#160;&#160;else&#160;self.layoutEdge(data)<br>&#160;&#160;&#160;&#160;end&#160;<br>&#160;&#160;end<br>end</FONT>
</TD></TR>
<TR><TD COLSPAN=2><a name="circulate"/><FONT FACE="Courier" SIZE="1">@Operation&#160;circulate(width&#160;:&#160;XCore::Element,height&#160;:&#160;XCore::Element,dx&#160;:&#160;XCore::Element,dy&#160;:&#160;XCore::Element):XCore::Element<br>&#160;&#160;let&#160;nodes&#160;=&#160;self.nodes;<br>&#160;&#160;&#160;&#160;&#160;&#160;edges&#160;=&#160;self.edges<br>&#160;&#160;in&#160;@Fork&#160;<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;let&#160;interval&#160;=&#160;360&#160;/&#160;nodes-&gt;size;<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;angle&#160;=&#160;0.0;<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;length&#160;=&#160;(width&#160;/&#160;2).min(height&#160;/&#160;2)<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;in&#160;@Count&#160;i&#160;from&#160;0&#160;to&#160;10&#160;do<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;let&#160;angle&#160;=&#160;0.0&#160;+&#160;i<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;in&#160;@For&#160;node&#160;in&#160;nodes&#160;do<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;let&#160;x&#160;=&#160;((length&#160;*&#160;angle.cos())&#160;+&#160;width&#160;/&#160;2).floor()&#160;+&#160;dx&#160;then<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;y&#160;=&#160;((length&#160;*&#160;angle.sin())&#160;+&#160;height&#160;/&#160;2).floor()&#160;+&#160;dy&#160;then<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;deltax&#160;=&#160;x&#160;-&#160;node.x;<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;deltay&#160;=&#160;y&#160;-&#160;node.y<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;in&#160;node.move(x,y);<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;@For&#160;port&#160;in&#160;node.ports()&#160;do<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;@For&#160;edge&#160;in&#160;edges&#160;do<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if&#160;edge.source&#160;=&#160;port&#160;and&#160;edge.target&#160;=&#160;port<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;then&#160;edge.applyDelta(Point(deltax,deltay))<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;else&#160;false<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end&#160;<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end;<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;self.yield()<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end;<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;angle&#160;:=&#160;angle&#160;+&#160;interval<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;end<br>&#160;&#160;&#160;&#160;&#160;end<br>&#160;&#160;end<br>end</FONT>
</TD></TR>
<TR><TD COLSPAN=2><a name="containsEdge"/><FONT FACE="Courier" SIZE="1">@Operation&#160;containsEdge(edge&#160;:&#160;XCore::Element):XCore::Element<br>&#160;&#160;edges-&gt;includes(edge)<br>end</FONT>
</TD></TR>
<TR><TD COLSPAN=2><a name="containsNode"/><FONT FACE="Courier" SIZE="1">@Operation&#160;containsNode(node&#160;:&#160;XCore::Element):XCore::Element<br>&#160;&#160;nodes-&gt;includes(node)<br>end</FONT>
</TD></TR>
<TR><TD COLSPAN=2><a name="deepContains"/><FONT FACE="Courier" SIZE="1">@Operation&#160;deepContains(n&#160;:&#160;Node):XCore::Element<br>&#160;&#160;let&#160;findSeq&#160;=&#160;nodes-&gt;asSeq;<br>&#160;&#160;&#160;&#160;&#160;&#160;findDone&#160;=&#160;false;<br>&#160;&#160;&#160;&#160;&#160;&#160;findResult&#160;=&#160;null<br>&#160;&#160;in&#160;declare(hidden,findSeq);<br>&#160;&#160;&#160;&#160;&#160;declare(hidden,findDone);<br>&#160;&#160;&#160;&#160;&#160;declare(hidden,findResult);<br>&#160;&#160;&#160;&#160;&#160;@While&#160;not&#160;findSeq-&gt;isEmpty&#160;and&#160;not&#160;findDone&#160;do<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;let&#160;node&#160;=&#160;findSeq-&gt;head&#160;then<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;findElement&#160;=&#160;findSeq-&gt;head<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;in&#160;declare(hidden,findElement);<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if&#160;node&#160;=&#160;n<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;then&#160;<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;findDone&#160;:=&#160;true;<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;findResult&#160;:=&#160;true<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;else&#160;findSeq&#160;:=&#160;findSeq-&gt;tail<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end&#160;<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;end<br>&#160;&#160;&#160;&#160;&#160;end;<br>&#160;&#160;&#160;&#160;&#160;if&#160;not&#160;findDone<br>&#160;&#160;&#160;&#160;&#160;then&#160;let&#160;findSeq&#160;=&#160;nodes-&gt;asSeq;<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;findDone&#160;=&#160;false;<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;findResult&#160;=&#160;null<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;in&#160;declare(hidden,findSeq);<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;declare(hidden,findDone);<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;declare(hidden,findResult);<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;@While&#160;not&#160;findSeq-&gt;isEmpty&#160;and&#160;not&#160;findDone&#160;do<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;let&#160;node&#160;=&#160;findSeq-&gt;head&#160;then<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;findElement&#160;=&#160;findSeq-&gt;head<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;in&#160;declare(hidden,findElement);<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if&#160;node.deepContains(n)<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;then&#160;<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;findDone&#160;:=&#160;true;<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;findResult&#160;:=&#160;true<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;else&#160;findSeq&#160;:=&#160;findSeq-&gt;tail<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end&#160;<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end;<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if&#160;not&#160;findDone<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;then&#160;false<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;else&#160;findResult<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end&#160;<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end<br>&#160;&#160;&#160;&#160;&#160;else&#160;findResult<br>&#160;&#160;&#160;&#160;&#160;end&#160;<br>&#160;&#160;end<br>end</FONT>
</TD></TR>
<TR><TD COLSPAN=2><a name="delete"/><FONT FACE="Courier" SIZE="1">@Operation&#160;delete():XCore::Element<br>&#160;&#160;@For&#160;edge&#160;in&#160;edges&#160;do<br>&#160;&#160;&#160;&#160;edge.delete()<br>&#160;&#160;end;<br>&#160;&#160;@For&#160;node&#160;in&#160;nodes&#160;do<br>&#160;&#160;&#160;&#160;node.delete()<br>&#160;&#160;end<br>end</FONT>
</TD></TR>
<TR><TD COLSPAN=2><a name="deselectAll"/><FONT FACE="Courier" SIZE="1">@Operation&#160;deselectAll():XCore::Element<br>&#160;&#160;@For&#160;node&#160;in&#160;nodes&#160;do<br>&#160;&#160;&#160;&#160;node.setSelected(false)<br>&#160;&#160;end;<br>&#160;&#160;@For&#160;edge&#160;in&#160;edges&#160;do<br>&#160;&#160;&#160;&#160;edge.setSelected(false)<br>&#160;&#160;end<br>end</FONT>
</TD></TR>
<TR><TD COLSPAN=2><a name="dispose"/><FONT FACE="Courier" SIZE="1">@Operation&#160;dispose():XCore::Element<br>&#160;&#160;@For&#160;node&#160;in&#160;nodes&#160;do<br>&#160;&#160;&#160;&#160;node.dispose()<br>&#160;&#160;end;<br>&#160;&#160;@For&#160;edge&#160;in&#160;edges&#160;do<br>&#160;&#160;&#160;&#160;edge.dispose()<br>&#160;&#160;end<br>end</FONT>
</TD></TR>
<TR><TD COLSPAN=2><a name="disposeId"/><FONT FACE="Courier" SIZE="1">@Operation&#160;disposeId(disposeChildren&#160;:&#160;XCore::Element):XCore::Element<br>&#160;&#160;@For&#160;node&#160;in&#160;nodes&#160;do<br>&#160;&#160;&#160;&#160;node.disposeId(disposeChildren)<br>&#160;&#160;end;<br>&#160;&#160;@For&#160;edge&#160;in&#160;edges&#160;do<br>&#160;&#160;&#160;&#160;edge.disposeId(disposeChildren)<br>&#160;&#160;end<br>end</FONT>
</TD></TR>
<TR><TD COLSPAN=2><a name="edges"/><FONT FACE="Courier" SIZE="1">@Operation&#160;edges[ACCESSOR=true]():XCore::Element<br>&#160;&#160;self.edges<br>end</FONT>
</TD></TR>
<TR><TD COLSPAN=2><a name="edgesConnectedTo"/><FONT FACE="Courier" SIZE="1">@Operation&#160;edgesConnectedTo(node&#160;:&#160;XCore::Element):XCore::Element<br>&#160;&#160;let&#160;connectedEdges&#160;=&#160;Set{}<br>&#160;&#160;in&#160;@For&#160;edge&#160;in&#160;edges&#160;do<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;if&#160;node.ports-&gt;includes(edge.source)&#160;or&#160;node.ports-&gt;includes(edge.target)<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;then&#160;connectedEdges&#160;:=&#160;connectedEdges-&gt;including(edge)<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;else&#160;false<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;end&#160;<br>&#160;&#160;&#160;&#160;&#160;end;<br>&#160;&#160;&#160;&#160;&#160;connectedEdges<br>&#160;&#160;end<br>end</FONT>
</TD></TR>
<TR><TD COLSPAN=2><a name="findEdgeElement"/><FONT FACE="Courier" SIZE="1">@Operation&#160;findEdgeElement(id&#160;:&#160;XCore::Element):XCore::Element<br>&#160;&#160;let&#160;findSeq&#160;=&#160;edges-&gt;asSeq;<br>&#160;&#160;&#160;&#160;&#160;&#160;findDone&#160;=&#160;false;<br>&#160;&#160;&#160;&#160;&#160;&#160;findResult&#160;=&#160;null<br>&#160;&#160;in&#160;declare(hidden,findSeq);<br>&#160;&#160;&#160;&#160;&#160;declare(hidden,findDone);<br>&#160;&#160;&#160;&#160;&#160;declare(hidden,findResult);<br>&#160;&#160;&#160;&#160;&#160;@While&#160;not&#160;findSeq-&gt;isEmpty&#160;and&#160;not&#160;findDone&#160;do<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;let&#160;edge&#160;=&#160;findSeq-&gt;head&#160;then<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;findElement&#160;=&#160;findSeq-&gt;head<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;in&#160;declare(hidden,findElement);<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if&#160;edge.findElement(id)&#160;&lt;&gt;&#160;null<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;then&#160;<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;findDone&#160;:=&#160;true;<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;findResult&#160;:=&#160;edge.findElement(id)<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;else&#160;findSeq&#160;:=&#160;findSeq-&gt;tail<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end&#160;<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;end<br>&#160;&#160;&#160;&#160;&#160;end;<br>&#160;&#160;&#160;&#160;&#160;if&#160;not&#160;findDone<br>&#160;&#160;&#160;&#160;&#160;then&#160;null<br>&#160;&#160;&#160;&#160;&#160;else&#160;findResult<br>&#160;&#160;&#160;&#160;&#160;end&#160;<br>&#160;&#160;end<br>end</FONT>
</TD></TR>
<TR><TD COLSPAN=2><a name="findElement"/><FONT FACE="Courier" SIZE="1">@Operation&#160;findElement(id&#160;:&#160;Element):XCore::Element<br>&#160;&#160;let&#160;e&#160;=&#160;self.findNodeElement(id)<br>&#160;&#160;in&#160;if&#160;e&#160;=&#160;null<br>&#160;&#160;&#160;&#160;&#160;then&#160;self.findEdgeElement(id)<br>&#160;&#160;&#160;&#160;&#160;else&#160;e<br>&#160;&#160;&#160;&#160;&#160;end&#160;<br>&#160;&#160;end<br>end</FONT>
</TD></TR>
<TR><TD COLSPAN=2><a name="findNodeElement"/><FONT FACE="Courier" SIZE="1">@Operation&#160;findNodeElement(id&#160;:&#160;XCore::Element):XCore::Element<br>&#160;&#160;let&#160;findSeq&#160;=&#160;nodes-&gt;asSeq;<br>&#160;&#160;&#160;&#160;&#160;&#160;findDone&#160;=&#160;false;<br>&#160;&#160;&#160;&#160;&#160;&#160;findResult&#160;=&#160;null<br>&#160;&#160;in&#160;declare(hidden,findSeq);<br>&#160;&#160;&#160;&#160;&#160;declare(hidden,findDone);<br>&#160;&#160;&#160;&#160;&#160;declare(hidden,findResult);<br>&#160;&#160;&#160;&#160;&#160;@While&#160;not&#160;findSeq-&gt;isEmpty&#160;and&#160;not&#160;findDone&#160;do<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;let&#160;node&#160;=&#160;findSeq-&gt;head&#160;then<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;findElement&#160;=&#160;findSeq-&gt;head<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;in&#160;declare(hidden,findElement);<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if&#160;node.findElement(id)&#160;&lt;&gt;&#160;null<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;then&#160;<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;findDone&#160;:=&#160;true;<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;findResult&#160;:=&#160;node.findElement(id)<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;else&#160;findSeq&#160;:=&#160;findSeq-&gt;tail<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end&#160;<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;end<br>&#160;&#160;&#160;&#160;&#160;end;<br>&#160;&#160;&#160;&#160;&#160;if&#160;not&#160;findDone<br>&#160;&#160;&#160;&#160;&#160;then&#160;null<br>&#160;&#160;&#160;&#160;&#160;else&#160;findResult<br>&#160;&#160;&#160;&#160;&#160;end&#160;<br>&#160;&#160;end<br>end</FONT>
</TD></TR>
<TR><TD COLSPAN=2><a name="layout"/><FONT FACE="Courier" SIZE="1">@Operation&#160;layout():XCore::Element<br>&#160;&#160;if&#160;nodes-&gt;forAll(n&#160;|<br>&#160;&#160;&#160;&#160;n.x&#160;=&#160;0&#160;and&#160;n.y&#160;=&#160;0)<br>&#160;&#160;then&#160;self.circulate(150,150,nodes-&gt;size&#160;*&#160;15,nodes-&gt;size&#160;*&#160;15)<br>&#160;&#160;else&#160;false<br>&#160;&#160;end&#160;;<br>&#160;&#160;let&#160;dialog&#160;=&#160;xmf.busy("Performing&#160;Layout",false)<br>&#160;&#160;in&#160;try<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;let&#160;result&#160;=&#160;let&#160;moved&#160;=&#160;true;<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;nodeTable&#160;=&#160;Table(10);<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;origPos&#160;=&#160;Table(10);<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;count&#160;=&#160;0;<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;v&#160;=&#160;Vector(4);<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;N&#160;=&#160;nodes-&gt;asSeq;<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;E&#160;=&#160;edges-&gt;asSeq<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;in&#160;@For&#160;node&#160;inSeq&#160;N&#160;do<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;nodeTable.put(node,Point(0,0));<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;origPos.put(node,Point(node.x,node.y))<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end;<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;@While&#160;moved&#160;and&#160;count&#160;&lt;&#160;300&#160;do<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;moved&#160;:=&#160;false;<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;count&#160;:=&#160;count&#160;+&#160;1;<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;@For&#160;node&#160;inSeq&#160;N&#160;do<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;let&#160;p&#160;=&#160;nodeTable.get(node)<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;in&#160;p.x&#160;:=&#160;node.x;<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;p.y&#160;:=&#160;node.y<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end;<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;@For&#160;n1&#160;inSeq&#160;N&#160;do<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;@For&#160;n2&#160;inSeq&#160;N&#160;do<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if&#160;n1&#160;&lt;&gt;&#160;n2<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;then&#160;let&#160;p1&#160;=&#160;Kernel_tableGet(nodeTable,n1);<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;p2&#160;=&#160;Kernel_tableGet(nodeTable,n2)<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;in&#160;if&#160;Kernel_graphLayout(p1.x,p1.y,p2.x,p2.y,v,150,false)<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;then&#160;<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;p1.x&#160;:=&#160;p1.x&#160;+&#160;v.ref(0);<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;p1.y&#160;:=&#160;p1.y&#160;+&#160;v.ref(1);<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;p2.x&#160;:=&#160;p2.x&#160;+&#160;v.ref(2);<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;p2.y&#160;:=&#160;p2.y&#160;+&#160;v.ref(3)<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;else&#160;false<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end&#160;<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;else&#160;false<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end&#160;<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end;<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;@For&#160;edge&#160;inSeq&#160;E&#160;do<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;let&#160;n1&#160;=&#160;edge.sourceNode();<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;n2&#160;=&#160;edge.targetNode()<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;in&#160;if&#160;n1&#160;&lt;&gt;&#160;n2<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;then&#160;let&#160;p1&#160;=&#160;Kernel_tableGet(nodeTable,n1);<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;p2&#160;=&#160;Kernel_tableGet(nodeTable,n2)<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;in&#160;if&#160;Kernel_graphLayout(p1.x,p1.y,p2.x,p2.y,v,400,true)<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;then&#160;<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;p1.x&#160;:=&#160;p1.x&#160;-&#160;v.ref(0);<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;p1.y&#160;:=&#160;p1.y&#160;-&#160;v.ref(1);<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;p2.x&#160;:=&#160;p2.x&#160;-&#160;v.ref(2);<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;p2.y&#160;:=&#160;p2.y&#160;-&#160;v.ref(3)<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;else&#160;false<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end&#160;<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;else&#160;false<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end&#160;<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end;<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;@For&#160;node&#160;inTableKeys&#160;nodeTable&#160;do<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;let&#160;p&#160;=&#160;Kernel_tableGet(nodeTable,node)&#160;then<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;x&#160;=&#160;p.x.abs();<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;y&#160;=&#160;p.y.abs()<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;in&#160;if&#160;not&#160;(x&#160;=&#160;node.x&#160;and&#160;y&#160;=&#160;node.y)<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;then&#160;<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;moved&#160;:=&#160;true;<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;node.x&#160;:=&#160;x;<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;node.y&#160;:=&#160;y<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;else&#160;false<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end&#160;<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end;<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;@For&#160;node&#160;inTableKeys&#160;nodeTable&#160;do<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;let&#160;op&#160;=&#160;Kernel_tableGet(origPos,node)&#160;then<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;deltax&#160;=&#160;node.x&#160;-&#160;op.x;<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;deltay&#160;=&#160;node.y&#160;-&#160;op.y<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;in&#160;node.move(node.x,node.y);<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;@For&#160;port&#160;in&#160;node.ports()&#160;do<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;@For&#160;edge&#160;in&#160;edges&#160;do<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if&#160;edge.source&#160;=&#160;port&#160;and&#160;edge.target&#160;=&#160;port<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;then&#160;edge.applyDelta(Point(deltax,deltay))<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;else&#160;false<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end&#160;<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;in&#160;if&#160;dialog&#160;&lt;&gt;&#160;null<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;then&#160;dialog.finished()<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;else&#160;false<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end&#160;;<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;result<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;end<br>&#160;&#160;&#160;&#160;&#160;catch(exception)<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;if&#160;dialog&#160;&lt;&gt;&#160;null<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;then&#160;dialog.finished()<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;else&#160;false<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;end&#160;;<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;throw&#160;exception<br>&#160;&#160;&#160;&#160;&#160;end<br>&#160;&#160;end<br>end</FONT>
</TD></TR>
<TR><TD COLSPAN=2><a name="layoutData"/><FONT FACE="Courier" SIZE="1">@Operation&#160;layoutData():Layout<br>&#160;&#160;Layout(self.layoutNodeData(),self.layoutEdgeData())<br>end</FONT>
</TD></TR>
<TR><TD COLSPAN=2><a name="layoutEdge"/><FONT FACE="Courier" SIZE="1">@Operation&#160;layoutEdge(layout&#160;:&#160;XML::Element):XCore::Element<br>&#160;&#160;let&#160;id&#160;=&#160;layout.getAtt("id");<br>&#160;&#160;&#160;&#160;&#160;&#160;sourceId&#160;=&#160;layout.getAtt("sourceId");<br>&#160;&#160;&#160;&#160;&#160;&#160;targetId&#160;=&#160;layout.getAtt("targetId");<br>&#160;&#160;&#160;&#160;&#160;&#160;hidden&#160;=&#160;layout.getAtt("hidden").asBool()&#160;then<br>&#160;&#160;&#160;&#160;&#160;&#160;findSeq&#160;=&#160;edges-&gt;asSeq;<br>&#160;&#160;&#160;&#160;&#160;&#160;findDone&#160;=&#160;false;<br>&#160;&#160;&#160;&#160;&#160;&#160;findResult&#160;=&#160;null<br>&#160;&#160;in&#160;declare(hidden,findSeq);<br>&#160;&#160;&#160;&#160;&#160;declare(hidden,findDone);<br>&#160;&#160;&#160;&#160;&#160;declare(hidden,findResult);<br>&#160;&#160;&#160;&#160;&#160;@While&#160;not&#160;findSeq-&gt;isEmpty&#160;and&#160;not&#160;findDone&#160;do<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;let&#160;edge&#160;=&#160;findSeq-&gt;head&#160;then<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;findElement&#160;=&#160;findSeq-&gt;head<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;in&#160;declare(hidden,findElement);<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if&#160;id&#160;=&#160;edge.layoutId()&#160;and&#160;edge.sourceNode().layoutId()&#160;=&#160;sourceId&#160;and&#160;edge.targetNode().layoutId()&#160;=&#160;targetId<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;then&#160;<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;findDone&#160;:=&#160;true;<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;findResult&#160;:=&#160;edge.applyLayout(layout);<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if&#160;hidden<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;then&#160;edge.hide()<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;else&#160;edge.showAnyway()<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end&#160;<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;else&#160;findSeq&#160;:=&#160;findSeq-&gt;tail<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end&#160;<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;end<br>&#160;&#160;&#160;&#160;&#160;end;<br>&#160;&#160;&#160;&#160;&#160;if&#160;not&#160;findDone<br>&#160;&#160;&#160;&#160;&#160;then&#160;false<br>&#160;&#160;&#160;&#160;&#160;else&#160;findResult<br>&#160;&#160;&#160;&#160;&#160;end&#160;<br>&#160;&#160;end<br>end</FONT>
</TD></TR>
<TR><TD COLSPAN=2><a name="layoutEdgeData"/><FONT FACE="Courier" SIZE="1">@Operation&#160;layoutEdgeData():Seq(XML::Element)<br>&#160;&#160;let&#160;edgeData&#160;=&#160;Seq{}<br>&#160;&#160;in&#160;@For&#160;edge&#160;in&#160;edges&#160;do<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;edgeData&#160;:=&#160;Seq{edge.layoutData()&#160;|&#160;edgeData}<br>&#160;&#160;&#160;&#160;&#160;end;<br>&#160;&#160;&#160;&#160;&#160;edgeData<br>&#160;&#160;end<br>end</FONT>
</TD></TR>
<TR><TD COLSPAN=2><a name="layoutMove"/><FONT FACE="Courier" SIZE="1">@Operation&#160;layoutMove(n1&#160;:&#160;XCore::Element,n2&#160;:&#160;XCore::Element,G&#160;:&#160;XCore::Element,checkDist&#160;:&#160;XCore::Element,nodeModifier&#160;:&#160;XCore::Element):XCore::Element<br>&#160;&#160;let&#160;dx1&#160;=&#160;(n1.x&#160;-&#160;n2.x);<br>&#160;&#160;&#160;&#160;&#160;&#160;dx2&#160;=&#160;(n2.x&#160;-&#160;n1.x);<br>&#160;&#160;&#160;&#160;&#160;&#160;dy1&#160;=&#160;n1.y&#160;-&#160;n2.y;<br>&#160;&#160;&#160;&#160;&#160;&#160;dy2&#160;=&#160;n2.y&#160;-&#160;n1.y&#160;then<br>&#160;&#160;&#160;&#160;&#160;&#160;x1r&#160;=&#160;dx1&#160;/&#160;(dx1.abs()&#160;+&#160;dy1.abs());<br>&#160;&#160;&#160;&#160;&#160;&#160;x2r&#160;=&#160;dx2&#160;/&#160;(dx2.abs()&#160;+&#160;dy2.abs());<br>&#160;&#160;&#160;&#160;&#160;&#160;y1r&#160;=&#160;dy1&#160;/&#160;(dx1.abs()&#160;+&#160;dy1.abs());<br>&#160;&#160;&#160;&#160;&#160;&#160;y2r&#160;=&#160;dy2&#160;/&#160;(dx2.abs()&#160;+&#160;dy2.abs());<br>&#160;&#160;&#160;&#160;&#160;&#160;dist&#160;=&#160;((dx1&#160;*&#160;dx1)&#160;+&#160;(dy1&#160;*&#160;dy1)).sqrt()&#160;then<br>&#160;&#160;&#160;&#160;&#160;&#160;mod&#160;=&#160;dist&#160;*&#160;dist&#160;*&#160;G&#160;then<br>&#160;&#160;&#160;&#160;&#160;&#160;modn1x&#160;=&#160;if&#160;x1r&#160;&lt;&#160;0<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;then&#160;(x1r&#160;/&#160;mod).floor()<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;else&#160;(x1r&#160;/&#160;mod).floor()&#160;+&#160;1<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end&#160;;<br>&#160;&#160;&#160;&#160;&#160;&#160;modn1y&#160;=&#160;if&#160;y1r&#160;&lt;&#160;0<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;then&#160;(y1r&#160;/&#160;mod).floor()<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;else&#160;(y1r&#160;/&#160;mod).floor()&#160;+&#160;1<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end&#160;;<br>&#160;&#160;&#160;&#160;&#160;&#160;modn2x&#160;=&#160;if&#160;x2r&#160;&lt;&#160;0<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;then&#160;(x2r&#160;/&#160;mod).floor()<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;else&#160;(x2r&#160;/&#160;mod).floor()&#160;+&#160;1<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end&#160;;<br>&#160;&#160;&#160;&#160;&#160;&#160;modn2y&#160;=&#160;if&#160;y2r&#160;&lt;&#160;0<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;then&#160;(y2r&#160;/&#160;mod).floor()<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;else&#160;(y2r&#160;/&#160;mod).floor()&#160;+&#160;1<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end&#160;<br>&#160;&#160;in&#160;if&#160;checkDist(dist)<br>&#160;&#160;&#160;&#160;&#160;then&#160;<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;n1.x&#160;:=&#160;nodeModifier(n1.x,modn1x);<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;n1.y&#160;:=&#160;nodeModifier(n1.y,modn1y);<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;n2.x&#160;:=&#160;nodeModifier(n2.x,modn2x);<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;n2.y&#160;:=&#160;nodeModifier(n2.y,modn2y)<br>&#160;&#160;&#160;&#160;&#160;else&#160;false<br>&#160;&#160;&#160;&#160;&#160;end&#160;<br>&#160;&#160;end<br>end</FONT>
</TD></TR>
<TR><TD COLSPAN=2><a name="layoutNode"/><FONT FACE="Courier" SIZE="1">@Operation&#160;layoutNode(layout&#160;:&#160;XML::Element):XCore::Element<br>&#160;&#160;let&#160;id&#160;=&#160;layout.getAtt("id");<br>&#160;&#160;&#160;&#160;&#160;&#160;x&#160;=&#160;layout.getAtt("x").asFloat().floor();<br>&#160;&#160;&#160;&#160;&#160;&#160;y&#160;=&#160;layout.getAtt("y").asFloat().floor();<br>&#160;&#160;&#160;&#160;&#160;&#160;width&#160;=&#160;layout.getAtt("width").asInt();<br>&#160;&#160;&#160;&#160;&#160;&#160;height&#160;=&#160;layout.getAtt("height").asInt();<br>&#160;&#160;&#160;&#160;&#160;&#160;hidden&#160;=&#160;layout.getAtt("hidden").asBool()&#160;then<br>&#160;&#160;&#160;&#160;&#160;&#160;findSeq&#160;=&#160;nodes-&gt;asSeq;<br>&#160;&#160;&#160;&#160;&#160;&#160;findDone&#160;=&#160;false;<br>&#160;&#160;&#160;&#160;&#160;&#160;findResult&#160;=&#160;null<br>&#160;&#160;in&#160;declare(hidden,findSeq);<br>&#160;&#160;&#160;&#160;&#160;declare(hidden,findDone);<br>&#160;&#160;&#160;&#160;&#160;declare(hidden,findResult);<br>&#160;&#160;&#160;&#160;&#160;@While&#160;not&#160;findSeq-&gt;isEmpty&#160;and&#160;not&#160;findDone&#160;do<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;let&#160;node&#160;=&#160;findSeq-&gt;head&#160;then<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;findElement&#160;=&#160;findSeq-&gt;head<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;in&#160;declare(hidden,findElement);<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if&#160;node.layoutId()&#160;=&#160;id<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;then&#160;<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;findDone&#160;:=&#160;true;<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;findResult&#160;:=&#160;node.move(x,y);<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;node.resize(width,height);<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if&#160;hidden<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;then&#160;node.hide()<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;else&#160;node.show()<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end&#160;<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;else&#160;findSeq&#160;:=&#160;findSeq-&gt;tail<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end&#160;<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;end<br>&#160;&#160;&#160;&#160;&#160;end;<br>&#160;&#160;&#160;&#160;&#160;if&#160;not&#160;findDone<br>&#160;&#160;&#160;&#160;&#160;then&#160;false<br>&#160;&#160;&#160;&#160;&#160;else&#160;findResult<br>&#160;&#160;&#160;&#160;&#160;end&#160;<br>&#160;&#160;end<br>end</FONT>
</TD></TR>
<TR><TD COLSPAN=2><a name="layoutNodeData"/><FONT FACE="Courier" SIZE="1">@Operation&#160;layoutNodeData():Seq(XML::Element)<br>&#160;&#160;let&#160;nodeData&#160;=&#160;Seq{}<br>&#160;&#160;in&#160;@For&#160;node&#160;in&#160;nodes&#160;do<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;nodeData&#160;:=&#160;Seq{node.layoutData()&#160;|&#160;nodeData}<br>&#160;&#160;&#160;&#160;&#160;end;<br>&#160;&#160;&#160;&#160;&#160;nodeData<br>&#160;&#160;end<br>end</FONT>
</TD></TR>
<TR><TD COLSPAN=2><a name="new"/><FONT FACE="Courier" SIZE="1">@Operation&#160;new(diagram&#160;:&#160;XCore::Element,setMenu&#160;:&#160;XCore::Element):XCore::Element<br>&#160;&#160;@For&#160;node&#160;in&#160;nodes&#160;do<br>&#160;&#160;&#160;&#160;node.new(diagram,setMenu)<br>&#160;&#160;end;<br>&#160;&#160;@For&#160;edge&#160;in&#160;edges&#160;do<br>&#160;&#160;&#160;&#160;edge.new(diagram,setMenu)<br>&#160;&#160;end;<br>&#160;&#160;self<br>end</FONT>
</TD></TR>
<TR><TD COLSPAN=2><a name="new"/><FONT FACE="Courier" SIZE="1">@Operation&#160;new(parent&#160;:&#160;XCore::Element):XCore::Element<br>&#160;&#160;self.new(parent,true)<br>end</FONT>
</TD></TR>
<TR><TD COLSPAN=2><a name="nodes"/><FONT FACE="Courier" SIZE="1">@Operation&#160;nodes[ACCESSOR=true]():XCore::Element<br>&#160;&#160;self.nodes<br>end</FONT>
</TD></TR>
<TR><TD COLSPAN=2><a name="preferenceChange"/><FONT FACE="Courier" SIZE="1">@Operation&#160;preferenceChange():XCore::Element<br>&#160;&#160;@For&#160;node&#160;in&#160;nodes&#160;do<br>&#160;&#160;&#160;&#160;node.preferenceChange()<br>&#160;&#160;end<br>end</FONT>
</TD></TR>
<TR><TD COLSPAN=2><a name="removeEdge"/><FONT FACE="Courier" SIZE="1">@Operation&#160;removeEdge(edge&#160;:&#160;XCore::Element):XCore::Element<br>&#160;&#160;self.edges&#160;:=&#160;edges.excluding(edge)<br>end</FONT>
</TD></TR>
<TR><TD COLSPAN=2><a name="removeNode"/><FONT FACE="Courier" SIZE="1">@Operation&#160;removeNode(node&#160;:&#160;XCore::Element):XCore::Element<br>&#160;&#160;self.nodes&#160;:=&#160;nodes.excluding(node);<br>&#160;&#160;@For&#160;edge&#160;in&#160;edges&#160;do<br>&#160;&#160;&#160;&#160;if&#160;node.ports-&gt;includes(edge.source)&#160;or&#160;node.ports-&gt;includes(edge.target)<br>&#160;&#160;&#160;&#160;then&#160;edge.delete()<br>&#160;&#160;&#160;&#160;else&#160;false<br>&#160;&#160;&#160;&#160;end&#160;<br>&#160;&#160;end<br>end</FONT>
</TD></TR>
<TR><TD COLSPAN=2><a name="renew"/><FONT FACE="Courier" SIZE="1">@Operation&#160;renew(diagram&#160;:&#160;XCore::Element):XCore::Element<br>&#160;&#160;xmf.menuManager().protectProxyTable(true);<br>&#160;&#160;self.disposeId(true);<br>&#160;&#160;xmf.menuManager().protectProxyTable(false);<br>&#160;&#160;@For&#160;node&#160;in&#160;nodes&#160;do<br>&#160;&#160;&#160;&#160;node.renew(diagram)<br>&#160;&#160;end;<br>&#160;&#160;@For&#160;edge&#160;in&#160;edges&#160;do<br>&#160;&#160;&#160;&#160;edge.renew(diagram)<br>&#160;&#160;end;<br>&#160;&#160;self<br>end</FONT>
</TD></TR>
<TR><TD COLSPAN=2><a name="selected"/><FONT FACE="Courier" SIZE="1">@Operation&#160;selected():XCore::Element<br>&#160;&#160;let&#160;selected&#160;=&#160;Seq{}<br>&#160;&#160;in&#160;@For&#160;node&#160;in&#160;nodes&#160;do<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;if&#160;node.selected()<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;then&#160;selected&#160;:=&#160;Seq{node&#160;|&#160;selected}<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;else&#160;false<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;end&#160;<br>&#160;&#160;&#160;&#160;&#160;end;<br>&#160;&#160;&#160;&#160;&#160;@For&#160;edge&#160;in&#160;edges&#160;do<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;if&#160;edge.selected()<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;then&#160;selected&#160;:=&#160;Seq{edge&#160;|&#160;selected}<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;else&#160;false<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;end&#160;<br>&#160;&#160;&#160;&#160;&#160;end;<br>&#160;&#160;&#160;&#160;&#160;selected<br>&#160;&#160;end<br>end</FONT>
</TD></TR>
<TR><TD COLSPAN=2><a name="sourceNode"/><FONT FACE="Courier" SIZE="1">@Operation&#160;sourceNode(edge&#160;:&#160;XCore::Element):XCore::Element<br>&#160;&#160;let&#160;findSeq&#160;=&#160;nodes-&gt;asSeq;<br>&#160;&#160;&#160;&#160;&#160;&#160;findDone&#160;=&#160;false;<br>&#160;&#160;&#160;&#160;&#160;&#160;findResult&#160;=&#160;null<br>&#160;&#160;in&#160;declare(hidden,findSeq);<br>&#160;&#160;&#160;&#160;&#160;declare(hidden,findDone);<br>&#160;&#160;&#160;&#160;&#160;declare(hidden,findResult);<br>&#160;&#160;&#160;&#160;&#160;@While&#160;not&#160;findSeq-&gt;isEmpty&#160;and&#160;not&#160;findDone&#160;do<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;let&#160;node&#160;=&#160;findSeq-&gt;head&#160;then<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;findElement&#160;=&#160;findSeq-&gt;head<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;in&#160;declare(hidden,findElement);<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if&#160;node.ports-&gt;includes(edge.source)<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;then&#160;<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;findDone&#160;:=&#160;true;<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;findResult&#160;:=&#160;findElement<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;else&#160;findSeq&#160;:=&#160;findSeq-&gt;tail<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end&#160;<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;end<br>&#160;&#160;&#160;&#160;&#160;end;<br>&#160;&#160;&#160;&#160;&#160;if&#160;not&#160;findDone<br>&#160;&#160;&#160;&#160;&#160;then&#160;false<br>&#160;&#160;&#160;&#160;&#160;else&#160;findResult<br>&#160;&#160;&#160;&#160;&#160;end&#160;<br>&#160;&#160;end<br>end</FONT>
</TD></TR>
<TR><TD COLSPAN=2><a name="svgEdgeDecorators"/><FONT FACE="Courier" SIZE="1">@Operation&#160;svgEdgeDecorators(out&#160;:&#160;XCore::Element):XCore::Element<br>&#160;&#160;format(out,"&lt;marker&#160;id="decorator_0"/&gt;~%");<br>&#160;&#160;format(out,"&lt;marker&#160;id="decorator_1"&#160;viewBox="-20&#160;-10&#160;20&#160;20"<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;markerUnits="userSpaceOnUse"&#160;refX="0"&#160;refY="0"<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;markerWidth="10"&#160;markerHeight="10"&#160;orient="auto"<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;style="fill:none;stroke:black;stroke-width:2"&gt;~%");<br>&#160;&#160;format(out,"&lt;path&#160;d="M-20,-10&#160;L0,0&#160;-20,10"/&gt;~%");<br>&#160;&#160;format(out,"&lt;/marker&gt;~%");<br>&#160;&#160;format(out,"&lt;marker&#160;id="decorator_5"&#160;viewBox="-20&#160;-10&#160;20&#160;20"<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;markerUnits="userSpaceOnUse"&#160;refX="0"&#160;refY="0"<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;markerWidth="10"&#160;markerHeight="10"&#160;orient="auto"<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;style="fill:white;stroke:black;stroke-width:2"&gt;~%");<br>&#160;&#160;format(out,"&lt;path&#160;d="M-20,-10&#160;L0,0&#160;-20,10&#160;z"/&gt;~%");<br>&#160;&#160;format(out,"&lt;/marker&gt;~%")<br>end</FONT>
</TD></TR>
<TR><TD COLSPAN=2><a name="svgFooter"/><FONT FACE="Courier" SIZE="1">@Operation&#160;svgFooter(out&#160;:&#160;XCore::Element):XCore::Element<br>&#160;&#160;format(out,"&lt;/svg&gt;~%")<br>end</FONT>
</TD></TR>
<TR><TD COLSPAN=2><a name="svgHeader"/><FONT FACE="Courier" SIZE="1">@Operation&#160;svgHeader(out&#160;:&#160;XCore::Element):XCore::Element<br>&#160;&#160;let&#160;x&#160;=&#160;10000;<br>&#160;&#160;&#160;&#160;&#160;&#160;y&#160;=&#160;10000;<br>&#160;&#160;&#160;&#160;&#160;&#160;width&#160;=&#160;0;<br>&#160;&#160;&#160;&#160;&#160;&#160;height&#160;=&#160;0<br>&#160;&#160;in&#160;@For&#160;node&#160;in&#160;nodes&#160;do<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;x&#160;:=&#160;x.min(node.x);<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;y&#160;:=&#160;y.min(node.y);<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;width&#160;:=&#160;width.max(node.x&#160;+&#160;node.width);<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;height&#160;:=&#160;height.max(node.y&#160;+&#160;node.height)<br>&#160;&#160;&#160;&#160;&#160;end;<br>&#160;&#160;&#160;&#160;&#160;@For&#160;edge&#160;in&#160;edges&#160;do<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;@For&#160;waypoint&#160;in&#160;edge.wayPoints&#160;do<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;x&#160;:=&#160;x.min(waypoint.x);<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;y&#160;:=&#160;y.min(waypoint.y);<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;width&#160;:=&#160;width.max(waypoint.x);<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;height&#160;:=&#160;height.max(waypoint.y)<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;end<br>&#160;&#160;&#160;&#160;&#160;end;<br>&#160;&#160;&#160;&#160;&#160;x&#160;:=&#160;x&#160;-&#160;5;<br>&#160;&#160;&#160;&#160;&#160;y&#160;:=&#160;y&#160;-&#160;5;<br>&#160;&#160;&#160;&#160;&#160;width&#160;:=&#160;(width&#160;-&#160;x)&#160;+&#160;5;<br>&#160;&#160;&#160;&#160;&#160;height&#160;:=&#160;(height&#160;-&#160;y)&#160;+&#160;5;<br>&#160;&#160;&#160;&#160;&#160;format(out,"&lt;?xml&#160;version="1.0"&#160;encoding="iso-8859-1"?&gt;~%&lt;!DOCTYPE&#160;svg&#160;PUBLIC&#160;"-//W3C//DTD&#160;SVG&#160;20000303&#160;Stylable//EN"&#160;"http://www.w3.org/2000/svg10-20000303-stylable"&gt;~%&lt;svg&#160;width="~S"&#160;height="~S"&#160;viewBox="~S&#160;~S&#160;~S&#160;~S"&gt;~%",Seq{width,height,x,y,width,height})<br>&#160;&#160;end<br>end</FONT>
</TD></TR>
<TR><TD COLSPAN=2><a name="synchronise"/><FONT FACE="Courier" SIZE="1">@Operation&#160;synchronise():XCore::Element<br>&#160;&#160;@For&#160;node&#160;in&#160;nodes&#160;do<br>&#160;&#160;&#160;&#160;node.synchronise()<br>&#160;&#160;end;<br>&#160;&#160;@For&#160;edge&#160;in&#160;edges&#160;do<br>&#160;&#160;&#160;&#160;edge.synchronise()<br>&#160;&#160;end<br>end</FONT>
</TD></TR>
<TR><TD COLSPAN=2><a name="targetNode"/><FONT FACE="Courier" SIZE="1">@Operation&#160;targetNode(edge&#160;:&#160;XCore::Element):XCore::Element<br>&#160;&#160;let&#160;findSeq&#160;=&#160;nodes-&gt;asSeq;<br>&#160;&#160;&#160;&#160;&#160;&#160;findDone&#160;=&#160;false;<br>&#160;&#160;&#160;&#160;&#160;&#160;findResult&#160;=&#160;null<br>&#160;&#160;in&#160;declare(hidden,findSeq);<br>&#160;&#160;&#160;&#160;&#160;declare(hidden,findDone);<br>&#160;&#160;&#160;&#160;&#160;declare(hidden,findResult);<br>&#160;&#160;&#160;&#160;&#160;@While&#160;not&#160;findSeq-&gt;isEmpty&#160;and&#160;not&#160;findDone&#160;do<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;let&#160;node&#160;=&#160;findSeq-&gt;head&#160;then<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;findElement&#160;=&#160;findSeq-&gt;head<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;in&#160;declare(hidden,findElement);<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if&#160;node.ports-&gt;includes(edge.target)<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;then&#160;<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;findDone&#160;:=&#160;true;<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;findResult&#160;:=&#160;findElement<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;else&#160;findSeq&#160;:=&#160;findSeq-&gt;tail<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end&#160;<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;end<br>&#160;&#160;&#160;&#160;&#160;end;<br>&#160;&#160;&#160;&#160;&#160;if&#160;not&#160;findDone<br>&#160;&#160;&#160;&#160;&#160;then&#160;false<br>&#160;&#160;&#160;&#160;&#160;else&#160;findResult<br>&#160;&#160;&#160;&#160;&#160;end&#160;<br>&#160;&#160;end<br>end</FONT>
</TD></TR>
<TR><TD COLSPAN=2><a name="toSVG"/><FONT FACE="Courier" SIZE="1">@Operation&#160;toSVG(out&#160;:&#160;XCore::Element):XCore::Element<br>&#160;&#160;self.svgHeader(out);<br>&#160;&#160;self.svgEdgeDecorators(out);<br>&#160;&#160;@For&#160;node&#160;in&#160;nodes&#160;do<br>&#160;&#160;&#160;&#160;node.toSVG(out)<br>&#160;&#160;end;<br>&#160;&#160;@For&#160;edge&#160;in&#160;edges&#160;do<br>&#160;&#160;&#160;&#160;edge.toSVG(out)<br>&#160;&#160;end;<br>&#160;&#160;self.svgFooter(out)<br>end</FONT>
</TD></TR>
</FONT>
</TD>
</TR>
</TABLE>
</HTML>
